# C√≥digos Colunas Calculadas Projeto Metas (calend√°rio)

***Descri√ß√£o do c√≥digo***

<aside>
üí°

</aside>

```r
//
DiaSemana = WEEKDAY('Calend√°rio'[Date],1)

//
m√©dia de vendas = CALCULATE([Mgeral],FILTER(pedido,DATE(YEAR(pedido[dataPedido]),MONTH(pedido[dataPedido]),DAY(pedido[dataPedido]))>=DATE(2023,02,01)&&
                        NOT(pedido[statusPedido]in{"Cancelado", "Novo", "Cancelado Retornando"})&&
                        NOT(pedido[loja]in{"Lojas MM","Ta barato"})))

//
m√©dia di√°ria = AVERAGEX(SUMMARIZE(
                    FILTER(
                        ALL(pedido),EOMONTH(pedido[dataPedido],0)=EOMONTH('Calend√°rio'[Date],0)),
                    pedido[dataPedido],
                    "Toatal dia", SUM(pedido[total venda ajustado])
                    ), [Toatal dia])

//
Media m√™s atual = IF('Calend√°rio'[Date] < TODAY(), 0,CALCULATE([Mgeral],FILTER(pedido,DATE(YEAR(pedido[dataPedido]),MONTH(pedido[dataPedido]),DAY(pedido[dataPedido]))>=EOMONTH(TODAY(),-2) &&
                        NOT(pedido[statusPedido]in{"Cancelado", "Novo", "Cancelado Retornando"})&&
                        NOT(pedido[loja]in{"Lojas MM","Ta barato"}))))

//
m√™s = 'Calend√°rio'[Date].[M√™s]

//
Previs√£o de venda = 
// Previs√£o com base na m√©dia hist√≥rica.
'Calend√°rio'[m√©dia de vendas]+('Calend√°rio'[m√©dia de vendas]*'Calend√°rio'[Vari√ß√£o do dia])+('Calend√°rio'[m√©dia de vendas]*'Calend√°rio'[Varia√ß√£o do quarter])

//"Previs√£o com base na m√©dia do m√™s"
Previs√£o de venda m√™s = 
// Previs√£o com base na m√©dia m√™s.
'Calend√°rio'[Media m√™s atual]+('Calend√°rio'[Media m√™s atual]*'Calend√°rio'[Vari√ß√£o do dia])+('Calend√°rio'[Media m√™s atual]*'Calend√°rio'[Varia√ß√£o do quarter])

//
PrimeiroDiaMes = WEEKDAY(DATE(YEAR('Calend√°rio'[Date]), MONTH('Calend√°rio'[Date]), 1))

//
Quarter = CEILING(DAY('Calend√°rio'[Date]) /7.75,1)

//
semana = WEEKNUM('Calend√°rio'[Date])

//
Varia√ß√£o do quarter = 
VAR FiltroPedidos =
    FILTER(
        pedido,
        DATE(YEAR(pedido[dataPedido]), MONTH(pedido[dataPedido]), DAY(pedido[dataPedido])) >= DATE(2023, 02, 01) &&
        NOT(pedido[statusPedido] IN {"Cancelado", "Novo", "Cancelado Retornando"}) &&
        NOT(pedido[loja] IN {"Lojas MM", "Ta barato"})
    )
RETURN
    SWITCH(
        'Calend√°rio'[Quarter],
        1, CALCULATE([Quarter 01], FiltroPedidos),
        2, CALCULATE([Quarter 02], FiltroPedidos),
        3, CALCULATE([Quarter 03], FiltroPedidos),
        4, CALCULATE([Quarter 04], FiltroPedidos)
    )

//
Vari√ß√£o do dia = 
VAR FiltroPedidos =
    FILTER(
        pedido,
        DATE(YEAR(pedido[dataPedido]), MONTH(pedido[dataPedido]), DAY(pedido[dataPedido])) >= DATE(2023, 02, 01) &&
        NOT(pedido[statusPedido] IN {"Cancelado", "Novo", "Cancelado Retornando"}) &&
        NOT(pedido[loja] IN {"Lojas MM", "Ta barato"})
    )
RETURN
    SWITCH(
        WEEKDAY('Calend√°rio'[Date]),
        1, CALCULATE([Delt1], FiltroPedidos),
        2, CALCULATE([Delt2], FiltroPedidos),
        3, CALCULATE([Delt3], FiltroPedidos),
        4, CALCULATE([Delt4], FiltroPedidos),
        5, CALCULATE([Delt5], FiltroPedidos),
        6, CALCULATE([Delt6], FiltroPedidos),
        7, CALCULATE([Delt7], FiltroPedidos)
    

```
